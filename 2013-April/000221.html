<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Star-users] stalling
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/star-users/2013-April/index.html" >
   <LINK REL="made" HREF="mailto:star-users%40lists.berlios.de?Subject=Re%3A%20%5BStar-users%5D%20stalling&In-Reply-To=%3C5163d953.pAlwmwMCmerTqqBL%25Joerg.Schilling%40fokus.fraunhofer.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000220.html">
   <LINK REL="Next"  HREF="000222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Star-users] stalling</H1>
    <B>Joerg Schilling</B> 
    <A HREF="mailto:star-users%40lists.berlios.de?Subject=Re%3A%20%5BStar-users%5D%20stalling&In-Reply-To=%3C5163d953.pAlwmwMCmerTqqBL%25Joerg.Schilling%40fokus.fraunhofer.de%3E"
       TITLE="[Star-users] stalling">Joerg.Schilling at fokus.fraunhofer.de
       </A><BR>
    <I>Tue Apr  9 11:03:15 CEST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000220.html">[Star-users] stalling
</A></li>
        <LI>Next message: <A HREF="000222.html">[Star-users] stalling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ryan Lovett &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/star-users">rylo at berkeley.edu</A>&gt; wrote:

&gt;<i> With star 1.5.2 on the latest Solaris 10, we are seeing star appear to
</I>&gt;<i> stall in the middle of dumping a ZFS snapshot to tape. Attaching dtruss,
</I>&gt;<i> iosnoop, and opensnoop to the affected process shows no activity. We
</I>&gt;<i> invoke star with:
</I>&gt;<i>
</I>&gt;<i>   star -C /path/to/.zfs/snapshot/20130407 -c -S -acl artype=exustar \
</I>&gt;<i> 	-sparse -time -xdev \
</I>&gt;<i> 	-multivol -wtardumps -new-volume-script=/usr/local/sbin/mtx-next \
</I>&gt;<i> 	errctl=/usr/local/etc/star-errctl.conf \
</I>&gt;<i> 	-not pat=*/.Trash/* pat=*/.cache/* pat=*/.thumbnails/* pat=*/.nfs* \
</I>&gt;<i> 	level=0 fs-name=/path/to blocks=512 file=/dev/rmt/1cn .
</I>
First a warning: If you exclude parts of the filesystem from a dump, star will 
not be able to &quot;restore&quot; files that have been brought back into the &quot;visible&quot; 
parts of the dump by renaming a a directory that was in the excluded part.

This is because such an action does not set the &quot;ctime&quot; stamp on such files.

&gt;<i> I don't believe it is a problem with the tape device since we can kill the
</I>&gt;<i> hanging star and run another (on another filesystem) right after which
</I>&gt;<i> runs to completion.
</I>&gt;<i>
</I>&gt;<i> Does anything above suggest why the star process stalls or waits?
</I>&gt;<i>
</I>&gt;<i> How can one debug this further?
</I>
Your current statements do not include any information that could help.

The minimal information would be to run truss on both star processes in order 
to get the current state of the processes.

I assume that star is not looping, so this should show a syscall...

Also helpful would be a &quot;pstack&quot; outoput from both processes.

How much data did star already dump before stalling?

J&#246;rg

-- 
 EMail:<A HREF="https://lists.berlios.de/mailman/listinfo/star-users">joerg at schily.isdn.cs.tu-berlin.de</A> (home) J&#246;rg Schilling D-13353 Berlin
       <A HREF="https://lists.berlios.de/mailman/listinfo/star-users">js at cs.tu-berlin.de</A>                (uni)  
       <A HREF="https://lists.berlios.de/mailman/listinfo/star-users">joerg.schilling at fokus.fraunhofer.de</A> (work) Blog: <A HREF="http://schily.blogspot.com/">http://schily.blogspot.com/</A>
 URL:  <A HREF="http://cdrecord.berlios.de/private/">http://cdrecord.berlios.de/private/</A> <A HREF="ftp://ftp.berlios.de/pub/schily">ftp://ftp.berlios.de/pub/schily</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000220.html">[Star-users] stalling
</A></li>
	<LI>Next message: <A HREF="000222.html">[Star-users] stalling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/star-users">More information about the Star-users
mailing list</a><br>
</body></html>
